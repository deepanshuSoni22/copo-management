{# academics/templates/academics/course_form.html #}
{% extends 'base.html' %}
{% load static %}

{% block title %}{{ form_title }}{% endblock %}

{% block content %}

    <div class="bg-white-pure rounded-lg shadow-md p-3 sm:p-4 lg:p-6 max-w-2xl mx-auto">
        <h1 class="text-xl sm:text-2xl lg:text-3xl font-bold text-gray-800 mb-6">{{ form_title }}</h1>
        
        <form method="post" class="space-y-6">
            {% csrf_token %}

            {% if form.non_field_errors %}
                <div class="bg-red-100 text-red-700 border border-red-200 p-3 rounded-md mb-4">
                    {% for error in form.non_field_errors %}
                        <p>{{ error }}</p>
                    {% endfor %}
                </div>
            {% endif %}

            <div>
                <label for="{{ form.name.id_for_label }}" class="block text-sm font-medium text-gray-default mb-1">{{ form.name.label }}</label>
                {{ form.name }}
                {% if form.name.errors %}
                    <p class="mt-2 text-sm text-red-600">{{ form.name.errors.as_text }}</p>
                {% endif %}
            </div>

            <div>
                <label for="{{ form.code.id_for_label }}" class="block text-sm font-medium text-gray-default mb-1">{{ form.code.label }}</label>
                {{ form.code }}
                {% if form.code.errors %}
                    <p class="mt-2 text-sm text-red-600">{{ form.code.errors.as_text }}</p>
                {% endif %}
            </div>

            <div>
                <label for="{{ form.department.id_for_label }}" class="block text-sm font-medium text-gray-default mb-1">{{ form.department.label }}</label>
                {{ form.department }}
                {% if form.department.errors %}
                    <p class="mt-2 text-sm text-red-600">{{ form.department.errors.as_text }}</p>
                {% endif %}
            </div>

            {# --- UPDATED: Semester field styling and labels --- #}
            <div>
                <label for="{{ form.semester.id_for_label }}" class="block text-sm font-medium text-gray-default mb-1">{{ form.semester.label }}</label>
                {{ form.semester }}
                {% if form.semester.errors %}
                    <p class="mt-2 text-sm text-red-600">{{ form.semester.errors.as_text }}</p>
                {% endif %}
            </div>
            {# --- END UPDATED --- #}

            <div>
                <label for="{{ form.faculty.id_for_label }}" class="block text-sm font-medium text-gray-default mb-1">{{ form.faculty.label }}</label>
                <div class="max-h-72 overflow-y-auto border border-gray-300 rounded-md p-3 space-y-2">
                    {% for checkbox in form.faculty %}
                      <label
                        for="{{ checkbox.id_for_label }}"
                        class="flex items-center space-x-3 p-2 border rounded-md cursor-pointer transition duration-150 ease-in-out hover:bg-indigo-50 peer-checked:bg-indigo-100"
                      >
                        {{ checkbox.tag }}
                        <span class="text-base text-gray-700">{{ checkbox.choice_label }}</span>
                      </label>
                    {% endfor %}
                </div>
            </div>

            <div class="mt-4">
                <label class="block text-sm font-medium text-gray-default mb-1">{{ form.students.label }}</label>
                
                <div class="max-h-48 overflow-y-auto border border-gray-300 rounded-md p-3 space-y-2">
                    {% for checkbox in form.students %}
                        <label
                            for="{{ checkbox.id_for_label }}"
                            class="flex items-center space-x-3 p-2 border rounded-md cursor-pointer transition duration-150 ease-in-out hover:bg-indigo-50"
                        >
                            {{ checkbox.tag }}
                            <span class="text-sm text-gray-700">{{ checkbox.choice_label }}</span>
                        </label>
                    {% endfor %}
                </div>
            
                {% if form.students.errors %}
                    <p class="mt-2 text-sm text-red-600">{{ form.students.errors.as_text }}</p>
                {% endif %}
            </div>
              

            <div class="flex items-center space-x-4 mt-6">
                <button type="submit"
                        class="inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white-pure bg-brand-purple hover:bg-brand-yellow hover:text-gray-900 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-brand-purple transition duration-150 ease-in-out">
                    Save Course
                </button>
                <a href="{% url 'course_list' %}"
                   class="inline-flex justify-center py-2 px-4 border border-border-default rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white-pure hover:bg-light-gray-bg focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-brand-purple transition duration-150 ease-in-out">
                    Cancel
                </a>
            </div>
        </form>
    </div>

{% endblock %}