{# copo_management_system/templates/base.html #}
{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}COPO Management System{% endblock %}</title>
    <link href="{% static 'dist/output.css' %}" rel="stylesheet">
    {% block extra_head %}{% endblock %}
</head>
<body class="bg-gray-100 font-poppins antialiased text-gray-800">
    <div id="app-wrapper" class="flex h-screen overflow-hidden"> {# Main flex container for sidebar + content #}

        {# --- Desktop/Tablet Sidebar --- #}
        {# Hidden on mobile, flex (visible) on large screens and up, collapsed on tablets #}
        <aside class="hidden lg:flex flex-col w-64 xl:w-72 bg-indigo-900 text-white shadow-xl z-30 transition-all duration-300">
            <div class="p-4 flex flex-col items-center justify-center border-b border-indigo-700">
                <a href="{% url 'home' %}" class="transition duration-200 hover:opacity-90 text-center">
                    <img src="{% static 'images/Trust_Logo.png' %}" 
                         alt="COPO Logo" 
                         class="w-auto h-16 sm:h-20 max-w-full mx-auto">
                    <span class="block mt-2 text-lg sm:text-xl font-bold text-white">
                        COPO Management System
                    </span>
                </a>
            </div>
            <nav class="flex-grow p-3 lg:p-4 space-y-1 lg:space-y-2 overflow-y-auto">
                <a href="{% url 'home' %}"
                   class="flex items-center px-3 lg:px-4 py-2 rounded-lg text-xs lg:text-sm font-medium transition duration-200
                          {% if request.resolver_match.url_name == 'home' %}bg-indigo-700 text-white shadow-md{% else %}text-indigo-200 hover:bg-indigo-800 hover:text-white{% endif %}">
                    <svg class="w-4 h-4 lg:w-5 lg:h-5 mr-2 lg:mr-3 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m0 0v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"></path></svg>
                    <span class="truncate">Dashboard</span>
                </a>
                {# NEW: User Management Link (Admin Only) #}
                {% if user.is_superuser or user.profile.role == 'ADMIN' %}
                    <a href="{% url 'user_list' %}"
                       class="flex items-center px-3 lg:px-4 py-2 rounded-lg text-xs lg:text-sm font-medium transition duration-200
                               {% if 'user_list' == request.resolver_match.url_name or 'user_create' == request.resolver_match.url_name or 'user_update' in request.resolver_match.url_name or 'user_delete' in request.resolver_match.url_name %}bg-indigo-700 text-white shadow-md{% else %}text-indigo-200 hover:bg-indigo-800 hover:text-white{% endif %}">
                        <svg class="w-4 h-4 lg:w-5 lg:h-5 mr-2 lg:mr-3 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h-4v-2a3 3 0 00-3-3H9a3 3 0 00-3 3v2H2M3 10V4a2 2 0 012-2h4a2 2 0 012 2v6m-4 0h6m-3 0V4a2 2 0 00-2-2H5a2 2 0 00-2 2v6m10-2h4a2 2 0 012 2v6m-2 0H14v-2a3 3 0 00-3-3h-2a3 3 0 00-3 3v2H2M3 10V4a2 2 0 012-2h4a2 2 0 012 2v6m-4 0h6m-3 0V4a2 2 0 00-2-2H5a2 2 0 00-2 2v6m10-2h4a2 2 0 012 2v6"></path></svg>
                        <span class="truncate">User Management</span>
                    </a>
                {% endif %}
                {% if user.is_superuser or user.profile.role == 'ADMIN' %}
                <a href="{% url 'academic_year_list' %}"
                   class="flex items-center px-3 lg:px-4 py-2 rounded-lg text-xs lg:text-sm font-medium transition duration-200
                          {% if 'academic_year' in request.resolver_match.url_name %}bg-indigo-700 text-white shadow-md{% else %}text-indigo-200 hover:bg-indigo-800 hover:text-white{% endif %}">
                    <svg class="w-4 h-4 lg:w-5 lg:h-5 mr-2 lg:mr-3 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"></path></svg>
                    <span class="truncate">Academic Years</span>
                </a>
                {% endif %}
                {# NEW: Department Link #}
                {% if user.is_superuser or user.profile.role == 'ADMIN' %}
                <a href="{% url 'department_list' %}"
                   class="flex items-center px-3 lg:px-4 py-2 rounded-lg text-xs lg:text-sm font-medium transition duration-200
                    {% if request.resolver_match.url_name == 'department_list' %} bg-indigo-700 text-white shadow-md{% else %}text-indigo-200 hover:bg-indigo-800 hover:text-white{% endif %}">
                    <svg class="w-4 h-4 lg:w-5 lg:h-5 mr-2 lg:mr-3 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m-1 4h1m-1 4h1m-5 3H9m14-8a2 2 0 01-2 2H7a2 2 0 01-2-2V7a2 2 0 012-2h10a2 2 0 012 2v12z"></path></svg>
                    <span class="truncate">Departments</span>
                </a>
                {% endif %}
                {# NEW: Academic Departments Link #}
                {% if user.is_superuser or user.profile.role == 'ADMIN' or user.profile.role == 'HOD' %}
                    <a href="{% url 'academic_department_list' %}"
                       class="flex items-center px-3 lg:px-4 py-2 rounded-lg text-xs lg:text-sm font-medium transition duration-200
                               {% if request.resolver_match.url_name == 'academic_department_list' %}bg-indigo-700 text-white shadow-md{% else %}text-indigo-200 hover:bg-indigo-800 hover:text-white{% endif %}">
                        <svg class="w-4 h-4 lg:w-5 lg:h-5 mr-2 lg:mr-3 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m-1 4h1m-1 4h1m-5 3H9m14-8a2 2 0 01-2 2H7a2 2 0 01-2-2V7a2 2 0 012-2h10a2 2 0 012 2v12z"></path></svg>
                        <span class="truncate">Academic Depts</span>
                    </a>
                {% endif %}
                {# NEW: Semesters Link #}
                {% if user.is_superuser or user.profile.role == 'ADMIN' or user.profile.role == 'HOD' %}
                    <a href="{% url 'semester_list' %}"
                       class="flex items-center px-3 lg:px-4 py-2 rounded-lg text-xs lg:text-sm font-medium transition duration-200
                               {% if 'semester' in request.resolver_match.url_name %}bg-indigo-700 text-white shadow-md{% else %}text-indigo-200 hover:bg-indigo-800 hover:text-white{% endif %}">
                        <svg class="w-4 h-4 lg:w-5 lg:h-5 mr-2 lg:mr-3 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01"></path></svg>
                        <span class="truncate">Semesters</span>
                    </a>
                {% endif %}
                {% if user.profile.role == 'STUDENT' %}
                <a href="{% url 'student_personal_marks_view' %}"
                    class="flex items-center px-3 lg:px-4 py-2 rounded-lg text-xs lg:text-sm font-medium transition duration-200
                    {% if 'student_personal_marks_view' == request.resolver_match.url_name %}bg-indigo-700 text-white shadow-md{% else %}text-indigo-200 hover:bg-indigo-800 hover:text-white{% endif %}">                    <svg class="w-4 h-4 lg:w-5 lg:h-5 mr-2 lg:mr-3 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"></path></svg>
                    <span class="truncate">My Marks</span>
                </a>
                {% endif %}
                {% if user.profile.role == 'STUDENT' %}
                <a href="{% url 'student_personal_attainment_view' %}"
                    class="flex items-center px-3 lg:px-4 py-2 rounded-lg text-xs lg:text-sm font-medium transition duration-200
                    {% if 'student_personal_attainment_view' == request.resolver_match.url_name %}bg-indigo-700 text-white shadow-md{% else %}text-indigo-200 hover:bg-indigo-800 hover:text-white{% endif %}">
                    <svg class="w-4 h-4 lg:w-5 lg:h-5 mr-2 lg:mr-3 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"></path></svg>
                    <span class="truncate">My Attainment</span>
                </a>
                {% endif %}
                {# More sidebar links will go here (e.g., Departments, Courses, etc.) #}
                {% if user.is_superuser or user.profile.role == 'ADMIN'%}
                {# NEW: Program Outcomes Link #}
                <a href="{% url 'program_outcome_list' %}"
                   class="flex items-center px-3 lg:px-4 py-2 rounded-lg text-xs lg:text-sm font-medium transition duration-200
                           {% if 'program_outcome' in request.resolver_match.url_name %}bg-indigo-700 text-white shadow-md{% else %}text-indigo-200 hover:bg-indigo-800 hover:text-white{% endif %}">
                    <svg class="w-4 h-4 lg:w-5 lg:h-5 mr-2 lg:mr-3 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 17v-2m3 2v-4m3 2v-6m2 9H7a2 2 0 01-2-2V5a2 2 0 012-2h10a2 2 0 012 2v12a2 2 0 01-2 2z"></path></svg>
                    <span class="truncate">Program Outcomes</span>
                </a>
                {% endif %}
                {% if user.is_superuser or user.profile.role == 'ADMIN' or user.profile.role == 'HOD' %}
                {# NEW: Assessment Types Link #}
                <a href="{% url 'assessment_type_list' %}"
                   class="flex items-center px-3 lg:px-4 py-2 rounded-lg text-xs lg:text-sm font-medium transition duration-200
                           {% if 'assessment_type' in request.resolver_match.url_name %}bg-indigo-700 text-white shadow-md{% else %}text-indigo-200 hover:bg-indigo-800 hover:text-white{% endif %}">
                    <svg class="w-4 h-4 lg:w-5 lg:h-5 mr-2 lg:mr-3 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path></svg>
                    <span class="truncate">Assessment Types</span>
                </a>
                {% endif %}
                {# NEW: Course Plans Link #}
                {% if user.profile.role == 'ADMIN' or user.profile.role == 'HOD'  or user.profile.role == 'FACULTY' %}
                    <a href="{% url 'course_plan_list' %}"
                       class="flex items-center px-3 lg:px-4 py-2 rounded-lg text-xs lg:text-sm font-medium transition duration-200
                               {% if 'course_plan' in request.resolver_match.url_name %}bg-indigo-700 text-white shadow-md{% else %}text-indigo-200 hover:bg-indigo-800 hover:text-white{% endif %}">
                        <svg class="w-4 h-4 lg:w-5 lg:h-5 mr-2 lg:mr-3 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path></svg>
                        <span class="truncate">Course Plans</span>
                    </a>
                {% endif %}
                {% if user.profile.role == 'ADMIN' or user.profile.role == 'HOD'  or user.profile.role == 'FACULTY' %}
                {# NEW: Course Link #}
                <a href="{% url 'course_list' %}"
                   class="flex items-center px-3 lg:px-4 py-2 rounded-lg text-xs lg:text-sm font-medium transition duration-200
                           {% if 'course_list' == request.resolver_match.url_name or 'course_create' == request.resolver_match.url_name or 'course_update' in request.resolver_match.url_name or 'course_delete' in request.resolver_match.url_name %}bg-indigo-700 text-white shadow-md{% else %}text-indigo-200 hover:bg-indigo-800 hover:text-white{% endif %}">
                    <svg class="w-4 h-4 lg:w-5 lg:h-5 mr-2 lg:mr-3 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13.438m0-13.438a4.5 4.5 0 100-9 4.5 4.5 0 000 9zm-7.5 0h15M12 6.253c1.867 0 3.682.525 5.176 1.426L22 4m-4 8a2 2 0 11-4 0 2 2 0 014 0zm-7.5 0h15"></path></svg>
                    <span class="truncate">Courses</span>
                </a>
                {% endif %}
                {% if user.profile.role == 'ADMIN' or user.profile.role == 'HOD'  or user.profile.role == 'FACULTY' %}
                {# NEW: Course Outcomes Link #}
                <a href="{% url 'course_outcome_list' %}"
                   class="flex items-center px-3 lg:px-4 py-2 rounded-lg text-xs lg:text-sm font-medium transition duration-200
                           {% if 'course_outcome' in request.resolver_match.url_name %}bg-indigo-700 text-white shadow-md{% else %}text-indigo-200 hover:bg-indigo-800 hover:text-white{% endif %}">
                    <svg class="w-4 h-4 lg:w-5 lg:h-5 mr-2 lg:mr-3 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01"></path></svg>
                    <span class="truncate">Course Outcomes</span>
                </a>
                {% endif %}
                {% if user.is_superuser or user.profile.role == 'ADMIN' or user.profile.role == 'HOD' or user.profile.role == 'FACULTY' %}
                {# NEW: Assessments Link #}
                <a href="{% url 'assessment_list' %}"
                   class="flex items-center px-3 lg:px-4 py-2 rounded-lg text-xs lg:text-sm font-medium transition duration-200
                           {% if 'assessment_' in request.resolver_match.url_name and 'assessment_type' not in request.resolver_match.url_name %}bg-indigo-700 text-white shadow-md{% else %}text-indigo-200 hover:bg-indigo-800 hover:text-white{% endif %}">
                    <svg class="w-4 h-4 lg:w-5 lg:h-5 mr-2 lg:mr-3 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01"></path></svg>
                    <span class="truncate">Assessments</span>
                </a>
                {% endif %}
                {% if user.profile.role == 'ADMIN' or user.profile.role == 'HOD' %}
                {# NEW: Calculate Attainment Link #}
                <a href="{% url 'calculate_attainment_view' %}"
                   class="flex items-center px-3 lg:px-4 py-2 rounded-lg text-xs lg:text-sm font-medium transition duration-200
                           {% if 'calculate_attainment' in request.resolver_match.url_name %}bg-indigo-700 text-white shadow-md{% else %}text-indigo-200 hover:bg-indigo-800 hover:text-white{% endif %}">
                    <svg class="w-4 h-4 lg:w-5 lg:h-5 mr-2 lg:mr-3 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"></path></svg>
                    <span class="truncate">Calculate Attainment</span>
                </a>
                {% endif %}
                {% if user.is_superuser or user.profile.role == 'ADMIN' or user.profile.role == 'HOD' or user.profile.role == 'FACULTY' %}
                {# NEW: Attainment Reports Group #}
                <div class="px-3 lg:px-4 pt-4 text-xs lg:text-sm font-semibold text-indigo-400 uppercase tracking-wider">
                    Attainment Reports
                </div>
                <a href="{% url 'co_attainment_report_list' %}"
                   class="flex items-center px-3 lg:px-4 py-2 rounded-lg text-xs lg:text-sm font-medium transition duration-200
                           {% if 'co_attainment_report' in request.resolver_match.url_name %}bg-indigo-700 text-white shadow-md{% else %}text-indigo-200 hover:bg-indigo-800 hover:text-white{% endif %}">
                    <svg class="w-4 h-4 lg:w-5 lg:h-5 mr-2 lg:mr-3 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 17v-2m3 2v-4m3 2v-6m2 9H7a2 2 0 01-2-2V5a2 2 0 012-2h10a2 2 0 012 2v12a2 2 0 01-2 2z"></path></svg>
                    <span class="truncate">CO Attainment</span>
                </a>
                <a href="{% url 'po_attainment_report_list' %}"
                   class="flex items-center px-3 lg:px-4 py-2 rounded-lg text-xs lg:text-sm font-medium transition duration-200
                           {% if 'po_attainment_report' in request.resolver_match.url_name %}bg-indigo-700 text-white shadow-md{% else %}text-indigo-200 hover:bg-indigo-800 hover:text-white{% endif %}">
                    <svg class="w-4 h-4 lg:w-5 lg:h-5 mr-2 lg:mr-3 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c1.558 0 3.093.048 4.606.145M12 8a7.964 7.964 0 00-2.348.608M12 8a7.964 7.964 0 012.348.608M9 17.25c.42.062.842.098 1.27.106M9 17.25a6.002 6.002 0 00-2.502-.377c-2.377-.502-4.14-.5-4.14-.5h-.001V12.75a.75.75 0 01.75-.75h3.582a3 3 0 001.309-3.774M15 17.25c-.42.062-.842.098-1.27.106m1.27-.106a6.002 6.002 0 012.502-.377c2.377-.502 4.14-.5 4.14-.5h.001V12.75a.75.75 0 00-.75-.75H17.25a3 3 0 01-1.309-3.774M12 8a9.002 9.002 0 00-2.032-.267M12 8a9.002 9.002 0 012.032-.267M9 17.25c-.42.062-.842.098-1.27.106M9 17.25a6.002 6.002 0 00-2.502-.377c-2.377-.502-4.14-.5-4.14-.5h-.001V12.75a.75.75 0 01.75-.75h3.582a3 3 0 001.309-3.774M15 17.25c-.42.062-.842.098-1.27.106m1.27-.106a6.002 6.002 0 012.502-.377c2.377-.502 4.14-.5 4.14-.5h.001V12.75a.75.75 0 00-.75-.75H17.25a3 3 0 01-1.309-3.774M12 8a9.002 9.002 0 00-2.032-.267"></path></svg>
                    <span class="truncate">PO Attainment</span>
                </a>
                {% endif %}
            </nav>
            
            {# Desktop User Section #}
            <div class="p-3 lg:p-4 border-t border-indigo-700">
                {% if user.is_authenticated %}
                    <div class="mb-2 lg:mb-3">
                        <p class="text-indigo-200 text-xs lg:text-sm truncate">
                            Hello, <span class="font-semibold text-white">{{ user.username }}</span>
                        </p>
                    </div>
                    <form action="{% url 'logout' %}" method="post">
                        {% csrf_token %}
                        <button type="submit"
                                class="w-full flex items-center justify-center px-3 lg:px-4 py-2 bg-indigo-700 hover:bg-indigo-600 rounded-lg text-xs lg:text-sm font-medium text-white transition duration-200 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-opacity-50">
                            <svg class="w-4 h-4 lg:w-5 lg:h-5 mr-2 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"></path></svg>
                            <span>Logout</span>
                        </button>
                    </form>
                {% else %}
                    <a href="{% url 'login' %}" 
                       class="w-full flex items-center justify-center px-3 lg:px-4 py-2 bg-indigo-700 hover:bg-indigo-600 rounded-lg text-xs lg:text-sm font-medium text-white transition duration-200 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-opacity-50">
                        <svg class="w-4 h-4 lg:w-5 lg:h-5 mr-2 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 16l-4-4m0 0l4-4m-4 4h14m-5 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h7a3 3 0 013 3v1"></path></svg>
                        <span>Login</span>
                    </a>
                {% endif %}
            </div>
        </aside>

        {# --- Tablet Collapsed Sidebar (Medium screens) --- #}
        <aside class="hidden md:flex lg:hidden flex-col w-16 bg-indigo-900 text-white shadow-xl z-30 transition-all duration-300">
            <div class="p-3 flex items-center justify-center border-b border-indigo-700">
                <a href="{% url 'home' %}" class="transition duration-200 hover:opacity-80">
                    <img src="{% static 'images/Trust_Logo.png' %}" 
                         alt="COPO Logo" 
                         class="h-12 sm:h-16 w-auto max-w-full rounded-full object-contain filter">
                </a>
            </div>            
            <nav class="flex-grow p-2 space-y-2 overflow-y-auto">
                <a href="{% url 'home' %}"
                   title="Dashboard"
                   class="flex items-center justify-center p-3 rounded-lg transition duration-200
                          {% if request.resolver_match.url_name == 'home' %}bg-indigo-700 text-white shadow-md{% else %}text-indigo-200 hover:bg-indigo-800 hover:text-white{% endif %}">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m0 0v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"></path></svg>
                </a>
                {# NEW: User Management Link (Admin Only) #}
                {% if user.is_superuser or user.profile.role == 'ADMIN' %}
                    <a href="{% url 'user_list' %}"
                       title="User Management"
                       class="flex items-center justify-center p-3 rounded-lg transition duration-200
                               {% if 'user_list' == request.resolver_match.url_name or 'user_create' == request.resolver_match.url_name or 'user_update' in request.resolver_match.url_name or 'user_delete' in request.resolver_match.url_name %}bg-indigo-700 text-white shadow-md{% else %}text-indigo-200 hover:bg-indigo-800 hover:text-white{% endif %}">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h-4v-2a3 3 0 00-3-3H9a3 3 0 00-3 3v2H2M3 10V4a2 2 0 012-2h4a2 2 0 012 2v6m-4 0h6m-3 0V4a2 2 0 00-2-2H5a2 2 0 00-2 2v6m10-2h4a2 2 0 012 2v6m-2 0H14v-2a3 3 0 00-3-3h-2a3 3 0 00-3 3v2H2M3 10V4a2 2 0 012-2h4a2 2 0 012 2v6m-4 0h6m-3 0V4a2 2 0 00-2-2H5a2 2 0 00-2 2v6m10-2h4a2 2 0 012 2v6"></path></svg>
                    </a>
                {% endif %}
                {% if user.is_superuser or user.profile.role == 'ADMIN' %}
                <a href="{% url 'academic_year_list' %}"
                   title="Academic Years"
                   class="flex items-center justify-center p-3 rounded-lg transition duration-200
                          {% if 'academic_year' in request.resolver_match.url_name %}bg-indigo-700 text-white shadow-md{% else %}text-indigo-200 hover:bg-indigo-800 hover:text-white{% endif %}">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"></path></svg>
                </a>
                {% endif %}
                {# NEW: Department Link #}
                {% if user.is_superuser or user.profile.role == 'ADMIN' %}
                <a href="{% url 'department_list' %}"
                   title="Departments"
                   class="flex items-center justify-center p-3 rounded-lg transition duration-200
                    {% if request.resolver_match.url_name == 'department_list' %}bg-indigo-700 text-white shadow-md{% else %}text-indigo-200 hover:bg-indigo-800 hover:text-white{% endif %}">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m-1 4h1m-1 4h1m-5 3H9m14-8a2 2 0 01-2 2H7a2 2 0 01-2-2V7a2 2 0 012-2h10a2 2 0 012 2v12z"></path></svg>
                </a>
                {% endif %}
                {# NEW: Academic Departments Link #}
                {% if user.is_superuser or user.profile.role == 'ADMIN' or user.profile.role == 'HOD' %}
                    <a href="{% url 'academic_department_list' %}"
                       title="Academic Departments"
                       class="flex items-center justify-center p-3 rounded-lg transition duration-200
                        {% if request.resolver_match.url_name == 'academic_department_list' %}bg-indigo-700 text-white shadow-md{% else %}text-indigo-200 hover:bg-indigo-800 hover:text-white{% endif %}">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m-1 4h1m-1 4h1m-5 3H9m14-8a2 2 0 01-2 2H7a2 2 0 01-2-2V7a2 2 0 012-2h10a2 2 0 012 2v12z"></path></svg>
                    </a>
                {% endif %}
                {# NEW: Semesters Link #}
                {% if user.is_superuser or user.profile.role == 'ADMIN' or user.profile.role == 'HOD' %}
                    <a href="{% url 'semester_list' %}"
                       title="Semesters"
                       class="flex items-center justify-center p-3 rounded-lg transition duration-200
                               {% if 'semester' in request.resolver_match.url_name %}bg-indigo-700 text-white shadow-md{% else %}text-indigo-200 hover:bg-indigo-800 hover:text-white{% endif %}">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01"></path></svg>
                    </a>
                {% endif %}
                {% if user.profile.role == 'STUDENT' %}
                <a href="{% url 'student_personal_marks_view' %}"
                    title="My Marks"
                    class="flex items-center justify-center p-3 rounded-lg transition duration-200
                    {% if 'student_personal_marks_view' == request.resolver_match.url_name %}bg-indigo-700 text-white shadow-md{% else %}text-indigo-200 hover:bg-indigo-800 hover:text-white{% endif %}">                    
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01"></path></svg>
                </a>
                {% endif %}
                {% if user.profile.role == 'STUDENT' %}
                <a href="{% url 'student_personal_attainment_view' %}"
                    title="My Attainment"
                    class="flex items-center justify-center p-3 rounded-lg transition duration-200
                    {% if 'student_personal_attainment_view' == request.resolver_match.url_name %}bg-indigo-700 text-white shadow-md{% else %}text-indigo-200 hover:bg-indigo-800 hover:text-white{% endif %}">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01"></path></svg>
                </a>
                {% endif %}
                {# More collapsed sidebar links will go here #}
                {# NEW: Program Outcomes Link #}
                {% if user.is_superuser or user.profile.role == 'ADMIN' %}
                <a href="{% url 'program_outcome_list' %}"
                   title="Program Outcomes"
                   class="flex items-center justify-center p-3 rounded-lg transition duration-200
                           {% if 'program_outcome' in request.resolver_match.url_name %}bg-indigo-700 text-white shadow-md{% else %}text-indigo-200 hover:bg-indigo-800 hover:text-white{% endif %}">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 17v-2m3 2v-4m3 2v-6m2 9H7a2 2 0 01-2-2V5a2 2 0 012-2h10a2 2 0 012 2v12a2 2 0 01-2 2z"></path></svg>
                </a>
                {% endif %}
                {# NEW: Assessment Types Link #}
                {% if user.is_superuser or user.profile.role == 'ADMIN' or user.profile.role == 'HOD' %}
                <a href="{% url 'assessment_type_list' %}"
                   title="Assessment Types"
                   class="flex items-center justify-center p-3 rounded-lg transition duration-200
                           {% if 'assessment_type' in request.resolver_match.url_name %}bg-indigo-700 text-white shadow-md{% else %}text-indigo-200 hover:bg-indigo-800 hover:text-white{% endif %}">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path></svg>
                </a>
                {% endif %}
                {# NEW: Course Plans Link #}
                {% if user.profile.role == 'ADMIN' or user.profile.role == 'HOD' or user.profile.role == 'FACULTY' %}
                    <a href="{% url 'course_plan_list' %}"
                       title="Course Plans"
                       class="flex items-center justify-center p-3 rounded-lg transition duration-200
                               {% if 'course_plan' in request.resolver_match.url_name %}bg-indigo-700 text-white shadow-md{% else %}text-indigo-200 hover:bg-indigo-800 hover:text-white{% endif %}">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path></svg>
                    </a>
                {% endif %}
                {# NEW: Course Link #}
                {% if user.profile.role == 'ADMIN' or user.profile.role == 'HOD' or user.profile.role == 'FACULTY' %}
                <a href="{% url 'course_list' %}"
                   title="Courses"
                   class="flex items-center justify-center p-3 rounded-lg transition duration-200
                           {% if 'course_list' == request.resolver_match.url_name or 'course_create' == request.resolver_match.url_name or 'course_update' in request.resolver_match.url_name or 'course_delete' in request.resolver_match.url_name %}bg-indigo-700 text-white shadow-md{% else %}text-indigo-200 hover:bg-indigo-800 hover:text-white{% endif %}">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13.438m0-13.438a4.5 4.5 0 100-9 4.5 4.5 0 000 9zm-7.5 0h15M12 6.253c1.867 0 3.682.525 5.176 1.426L22 4m-4 8a2 2 0 11-4 0 2 2 0 014 0zm-7.5 0h15"></path></svg>
                </a>
                {% endif %}
                {% if user.profile.role == 'ADMIN' or user.profile.role == 'HOD' or user.profile.role == 'FACULTY' %}
                {# NEW: Course Outcomes Link #}
                <a href="{% url 'course_outcome_list' %}"
                   title="Course Outcomes"
                   class="flex items-center justify-center p-3 rounded-lg transition duration-200
                           {% if 'course_outcome' in request.resolver_match.url_name %}bg-indigo-700 text-white shadow-md{% else %}text-indigo-200 hover:bg-indigo-800 hover:text-white{% endif %}">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01"></path></svg>
                </a>
                {% endif %}
                {# NEW: Assessments Link #}
                {% if user.is_superuser or user.profile.role == 'ADMIN' or user.profile.role == 'HOD' or user.profile.role == 'FACULTY' %}
                <a href="{% url 'assessment_list' %}"
                   title="Assessments"
                   class="flex items-center justify-center p-3 rounded-lg transition duration-200
                           {% if 'assessment_' in request.resolver_match.url_name and 'assessment_type' not in request.resolver_match.url_name %}bg-indigo-700 text-white shadow-md{% else %}text-indigo-200 hover:bg-indigo-800 hover:text-white{% endif %}">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01"></path></svg>
                </a>
                {% endif %}
                {# NEW: Calculate Attainment Link #}
                {% if user.profile.role == 'ADMIN' or user.profile.role == 'HOD' %}
                <a href="{% url 'calculate_attainment_view' %}"
                   title="Calculate Attainment"
                   class="flex items-center justify-center p-3 rounded-lg transition duration-200
                           {% if 'calculate_attainment' in request.resolver_match.url_name %}bg-indigo-700 text-white shadow-md{% else %}text-indigo-200 hover:bg-indigo-800 hover:text-white{% endif %}">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"></path></svg>
                </a>
                {% endif %}
                {% if user.is_superuser or user.profile.role == 'ADMIN' or user.profile.role == 'HOD' or user.profile.role == 'FACULTY' %}
                {# NEW: Attainment Reports Group #}
                <div class="px-2 pt-3 text-xs font-semibold text-indigo-400 uppercase tracking-wider truncate">
                    Reports
                </div>
                <a href="{% url 'co_attainment_report_list' %}"
                   title="CO Attainment"
                   class="flex items-center justify-center p-3 rounded-lg transition duration-200
                           {% if 'co_attainment_report' in request.resolver_match.url_name %}bg-indigo-700 text-white shadow-md{% else %}text-indigo-200 hover:bg-indigo-800 hover:text-white{% endif %}">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 17v-2m3 2v-4m3 2v-6m2 9H7a2 2 0 01-2-2V5a2 2 0 012-2h10a2 2 0 012 2v12a2 2 0 01-2 2z"></path></svg>
                </a>
                <a href="{% url 'po_attainment_report_list' %}"
                   title="PO Attainment"
                   class="flex items-center justify-center p-3 rounded-lg transition duration-200
                           {% if 'po_attainment_report' in request.resolver_match.url_name %}bg-indigo-700 text-white shadow-md{% else %}text-indigo-200 hover:bg-indigo-800 hover:text-white{% endif %}">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c1.558 0 3.093.048 4.606.145M12 8a7.964 7.964 0 00-2.348.608M12 8a7.964 7.964 0 012.348.608M9 17.25c.42.062.842.098 1.27.106M9 17.25a6.002 6.002 0 00-2.502-.377c-2.377-.502-4.14-.5-4.14-.5h-.001V12.75a.75.75 0 01.75-.75h3.582a3 3 0 001.309-3.774M15 17.25c-.42.062-.842.098-1.27.106m1.27-.106a6.002 6.002 0 012.502-.377c2.377-.502 4.14-.5 4.14-.5h.001V12.75a.75.75 0 00-.75-.75H17.25a3 3 0 01-1.309-3.774M12 8a9.002 9.002 0 00-2.032-.267M12 8a9.002 9.002 0 012.032-.267M9 17.25c-.42.062-.842.098-1.27.106M9 17.25a6.002 6.002 0 00-2.502-.377c-2.377-.502-4.14-.5-4.14-.5h-.001V12.75a.75.75 0 01.75-.75h3.582a3 3 0 001.309-3.774M15 17.25c-.42.062-.842.098-1.27.106m1.27-.106a6.002 6.002 0 012.502-.377c2.377-.502 4.14-.5 4.14-.5h.001V12.75a.75.75 0 00-.75-.75H17.25a3 3 0 01-1.309-3.774M12 8a9.002 9.002 0 00-2.032-.267"></path></svg>
                </a>
                {% endif %}
            </nav>
            
            {# Tablet Collapsed User Section #}
            <div class="p-2 border-t border-indigo-700">
                {% if user.is_authenticated %}
                    <form action="{% url 'logout' %}" method="post">
                        {% csrf_token %}
                        <button type="submit"
                                title="Logout ({{ user.username }})"
                                class="w-full flex items-center justify-center p-3 bg-indigo-700 hover:bg-indigo-600 rounded-lg transition duration-200 text-indigo-200 hover:text-white focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-opacity-50">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"></path></svg>
                        </button>
                    </form>
                {% else %}
                    <a href="{% url 'login' %}" 
                       title="Login"
                       class="w-full flex items-center justify-center p-3 bg-indigo-700 hover:bg-indigo-600 rounded-lg transition duration-200 text-indigo-200 hover:text-white focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-opacity-50">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 16l-4-4m0 0l4-4m-4 4h14m-5 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h7a3 3 0 013 3v1"></path></svg>
                    </a>
                {% endif %}
            </div>
        </aside>

        {# --- Mobile Menu (Off-canvas drawer and overlay) --- #}
        {# Initially hidden, toggled by JS #}
        <div id="mobile-menu-overlay" class="fixed inset-0 bg-black bg-opacity-50 z-40 hidden md:hidden transition-opacity duration-300"></div>
        <aside id="mobile-menu-drawer" class="fixed top-0 left-0 h-full w-64 sm:w-72 bg-indigo-900 text-white z-50 transform -translate-x-full transition-transform duration-300 ease-in-out md:hidden flex flex-col shadow-xl">
            <div class="p-4 sm:p-6 flex items-center justify-between border-b border-indigo-700">
                <a href="{% url 'home' %}" class="flex items-center space-x-2 sm:space-x-3 transition duration-200 hover:opacity-80">
                    <img src="{% static 'images/Trust_Logo.png' %}" alt="COPO Logo" class="h-8 w-8 sm:h-10 sm:w-10 filter">
                    <span class="text-lg sm:text-2xl font-bold tracking-tight">COPO System</span>
                </a>
                <button id="close-mobile-menu" class="text-indigo-200 hover:text-white focus:outline-none text-2xl transition duration-200">
                    &times; {# Simple 'x' icon #}
                </button>
            </div>
            <nav class="flex-grow p-3 sm:p-4 space-y-1 sm:space-y-2 overflow-y-auto">
                <a href="{% url 'home' %}"
                   class="flex items-center px-3 sm:px-4 py-2.5 sm:py-3 rounded-lg text-sm sm:text-base font-medium transition duration-200
                          {% if request.resolver_match.url_name == 'home' %}bg-indigo-700 text-white shadow-md{% else %}text-indigo-200 hover:bg-indigo-800 hover:text-white{% endif %}">
                    <svg class="w-5 h-5 mr-3 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m0 0v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"></path></svg>
                    Dashboard
                </a>
                {# NEW: User Management Link (Admin Only) #}
                {% if user.is_superuser or user.profile.role == 'ADMIN' %}
                    <a href="{% url 'user_list' %}"
                       class="flex items-center px-3 sm:px-4 py-2.5 sm:py-3 rounded-lg text-sm sm:text-base font-medium transition duration-200
                               {% if 'user_list' == request.resolver_match.url_name or 'user_create' == request.resolver_match.url_name or 'user_update' in request.resolver_match.url_name or 'user_delete' in request.resolver_match.url_name %}bg-indigo-700 text-white shadow-md{% else %}text-indigo-200 hover:bg-indigo-800 hover:text-white{% endif %}">
                        <svg class="w-5 h-5 mr-3 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h-4v-2a3 3 0 00-3-3H9a3 3 0 00-3 3v2H2M3 10V4a2 2 0 012-2h4a2 2 0 012 2v6m-4 0h6m-3 0V4a2 2 0 00-2-2H5a2 2 0 00-2 2v6m10-2h4a2 2 0 012 2v6m-2 0H14v-2a3 3 0 00-3-3h-2a3 3 0 00-3 3v2H2M3 10V4a2 2 0 012-2h4a2 2 0 012 2v6m-4 0h6m-3 0V4a2 2 0 00-2-2H5a2 2 0 00-2 2v6m10-2h4a2 2 0 012 2v6"></path></svg>
                        <span class="truncate">User Management</span>
                    </a>
                {% endif %}
                {% if user.is_superuser or user.profile.role == 'ADMIN' %}
                <a href="{% url 'academic_year_list' %}"
                   class="flex items-center px-3 sm:px-4 py-2.5 sm:py-3 rounded-lg text-sm sm:text-base font-medium transition duration-200
                          {% if 'academic_year' in request.resolver_match.url_name %}bg-indigo-700 text-white shadow-md{% else %}text-indigo-200 hover:bg-indigo-800 hover:text-white{% endif %}">
                    <svg class="w-5 h-5 mr-3 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"></path></svg>
                    Academic Years
                </a>
                {% endif %}
                {# NEW: Department Link #}
                {% if user.is_superuser or user.profile.role == 'ADMIN' %}
                <a href="{% url 'department_list' %}"
                   class="flex items-center px-3 sm:px-4 py-2.5 sm:py-3 rounded-lg text-sm sm:text-base font-medium transition duration-200
                    {% if request.resolver_match.url_name == 'department_list' %}bg-indigo-700 text-white shadow-md{% else %}text-indigo-200 hover:bg-indigo-800 hover:text-white{% endif %}">
                    <svg class="w-5 h-5 mr-3 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m-1 4h1m-1 4h1m-5 3H9m14-8a2 2 0 01-2 2H7a2 2 0 01-2-2V7a2 2 0 012-2h10a2 2 0 012 2v12z"></path></svg>
                    Departments
                </a>
                {% endif %}
                {# NEW: Academic Departments Link #}
                {% if user.is_superuser or user.profile.role == 'ADMIN' or user.profile.role == 'HOD' %}
                    <a href="{% url 'academic_department_list' %}"
                       class="flex items-center px-3 sm:px-4 py-2.5 sm:py-3 rounded-lg text-sm sm:text-base font-medium transition duration-200
                        {% if request.resolver_match.url_name == 'academic_department_list' %}bg-indigo-700 text-white shadow-md{% else %}text-indigo-200 hover:bg-indigo-800 hover:text-white{% endif %}">
                        <svg class="w-5 h-5 mr-3 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m-1 4h1m-1 4h1m-5 3H9m14-8a2 2 0 01-2 2H7a2 2 0 01-2-2V7a2 2 0 012-2h10a2 2 0 012 2v12z"></path></svg>
                        <span class="truncate">Academic Depts</span>
                    </a>
                {% endif %}
                {# NEW: Semesters Link #}
                {% if user.is_superuser or user.profile.role == 'ADMIN' or user.profile.role == 'HOD' %}
                    <a href="{% url 'semester_list' %}"
                       class="flex items-center px-3 sm:px-4 py-2.5 sm:py-3 rounded-lg text-sm sm:text-base font-medium transition duration-200
                               {% if 'semester' in request.resolver_match.url_name %}bg-indigo-700 text-white shadow-md{% else %}text-indigo-200 hover:bg-indigo-800 hover:text-white{% endif %}">
                        <svg class="w-5 h-5 mr-3 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01"></path></svg>
                        <span class="truncate">Semesters</span>
                    </a>
                {% endif %}
                {% if user.profile.role == 'STUDENT' %}
                <a href="{% url 'student_personal_marks_view' %}"
                    class="flex items-center px-3 sm:px-4 py-2.5 sm:py-3 rounded-lg text-sm sm:text-base font-medium transition duration-200
                    {% if 'student_personal_marks_view' == request.resolver_match.url_name %}bg-indigo-700 text-white shadow-md{% else %}text-indigo-200 hover:bg-indigo-800 hover:text-white{% endif %}">                    
                    <svg class="w-5 h-5 mr-3 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01"></path></svg>
                    My Marks
                </a>
                {% endif %}
                {% if user.profile.role == 'STUDENT' %}
                <a href="{% url 'student_personal_attainment_view' %}"
                    class="flex items-center px-3 sm:px-4 py-2.5 sm:py-3 rounded-lg text-sm sm:text-base font-medium transition duration-200
                    {% if 'student_personal_marks_view' == request.resolver_match.url_name %}bg-indigo-700 text-white shadow-md{% else %}text-indigo-200 hover:bg-indigo-800 hover:text-white{% endif %}">                    
                    <svg class="w-5 h-5 mr-3 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01"></path></svg>
                    My Attainment
                </a>
                {% endif %}
                {# More mobile sidebar links will go here #}
                {# NEW: Program Outcomes Link #}
                {% if user.is_superuser or user.profile.role == 'ADMIN' %}
                <a href="{% url 'program_outcome_list' %}"
                   class="flex items-center px-3 sm:px-4 py-2.5 sm:py-3 rounded-lg text-sm sm:text-base font-medium transition duration-200
                           {% if 'program_outcome' in request.resolver_match.url_name %}bg-indigo-700 text-white shadow-md{% else %}text-indigo-200 hover:bg-indigo-800 hover:text-white{% endif %}">
                    <svg class="w-5 h-5 mr-3 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 17v-2m3 2v-4m3 2v-6m2 9H7a2 2 0 01-2-2V5a2 2 0 012-2h10a2 2 0 012 2v12a2 2 0 01-2 2z"></path></svg>
                    Program Outcomes
                </a>
                {% endif %}
                {# NEW: Assessment Types Link #}
                {% if user.is_superuser or user.profile.role == 'ADMIN' or user.profile.role == 'HOD' %}
                <a href="{% url 'assessment_type_list' %}"
                   class="flex items-center px-3 sm:px-4 py-2.5 sm:py-3 rounded-lg text-sm sm:text-base font-medium transition duration-200
                           {% if 'assessment_type' in request.resolver_match.url_name %}bg-indigo-700 text-white shadow-md{% else %}text-indigo-200 hover:bg-indigo-800 hover:text-white{% endif %}">
                    <svg class="w-5 h-5 mr-3 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path></svg>
                    Assessment Types
                </a>
                {% endif %}
                {# NEW: Course Plans Link #}
                {% if user.profile.role == 'ADMIN' or user.profile.role == 'HOD' or user.profile.role == 'FACULTY' %}
                    <a href="{% url 'course_plan_list' %}"
                       class="flex items-center px-3 sm:px-4 py-2.5 sm:py-3 rounded-lg text-sm sm:text-base font-medium transition duration-200
                               {% if 'course_plan' in request.resolver_match.url_name %}bg-indigo-700 text-white shadow-md{% else %}text-indigo-200 hover:bg-indigo-800 hover:text-white{% endif %}">
                        <svg class="w-5 h-5 mr-3 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path></svg>
                        <span class="truncate">Course Plans</span>
                    </a>
                {% endif %}
                {# NEW: Course Link #}
                {% if user.profile.role == 'ADMIN' or user.profile.role == 'HOD' or user.profile.role == 'FACULTY' %}
                <a href="{% url 'course_list' %}"
                   class="flex items-center px-3 sm:px-4 py-2.5 sm:py-3 rounded-lg text-sm sm:text-base font-medium transition duration-200
                           {% if 'course_list' == request.resolver_match.url_name or 'course_create' == request.resolver_match.url_name or 'course_update' in request.resolver_match.url_name or 'course_delete' in request.resolver_match.url_name %}bg-indigo-700 text-white shadow-md{% else %}text-indigo-200 hover:bg-indigo-800 hover:text-white{% endif %}">
                    <svg class="w-5 h-5 mr-3 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13.438m0-13.438a4.5 4.5 0 100-9 4.5 4.5 0 000 9zm-7.5 0h15M12 6.253c1.867 0 3.682.525 5.176 1.426L22 4m-4 8a2 2 0 11-4 0 2 2 0 014 0zm-7.5 0h15"></path></svg>
                    Courses
                </a>
                {% endif %}
                {# NEW: Course Outcomes Link #}
                {% if user.profile.role == 'ADMIN' or user.profile.role == 'HOD' or user.profile.role == 'FACULTY' %}
                <a href="{% url 'course_outcome_list' %}"
                   class="flex items-center px-3 sm:px-4 py-2.5 sm:py-3 rounded-lg text-sm sm:text-base font-medium transition duration-200
                           {% if 'course_outcome' in request.resolver_match.url_name %}bg-indigo-700 text-white shadow-md{% else %}text-indigo-200 hover:bg-indigo-800 hover:text-white{% endif %}">
                    <svg class="w-5 h-5 mr-3 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01"></path></svg>
                    Course Outcomes
                </a>
                {% endif %}
                {# NEW: Assessments Link #}
                {% if user.is_superuser or user.profile.role == 'ADMIN' or user.profile.role == 'HOD' or user.profile.role == 'FACULTY' %}
                <a href="{% url 'assessment_list' %}"
                   class="flex items-center px-3 sm:px-4 py-2.5 sm:py-3 rounded-lg text-sm sm:text-base font-medium transition duration-200
                           {% if 'assessment_' in request.resolver_match.url_name and 'assessment_type' not in request.resolver_match.url_name %}bg-indigo-700 text-white shadow-md{% else %}text-indigo-200 hover:bg-indigo-800 hover:text-white{% endif %}">
                    <svg class="w-5 h-5 mr-3 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01"></path></svg>
                    Assessments
                </a>
                {% endif %}
                {# NEW: Calculate Attainment Link #}
                {% if user.profile.role == 'ADMIN' or user.profile.role == 'HOD' %}
                <a href="{% url 'calculate_attainment_view' %}"
                   class="flex items-center px-3 sm:px-4 py-2.5 sm:py-3 rounded-lg text-sm sm:text-base font-medium transition duration-200
                           {% if 'calculate_attainment' in request.resolver_match.url_name %}bg-indigo-700 text-white shadow-md{% else %}text-indigo-200 hover:bg-indigo-800 hover:text-white{% endif %}">
                    <svg class="w-5 h-5 mr-3 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"></path></svg>
                    Calculate Attainment
                </a>
                {% endif %}
                {# NEW: Attainment Reports Group #}
                {% if user.is_superuser or user.profile.role == 'ADMIN' or user.profile.role == 'HOD' or user.profile.role == 'FACULTY' %}
                <div class="px-3 sm:px-4 pt-4 text-xs sm:text-sm font-semibold text-indigo-400 uppercase tracking-wider">
                    Attainment Reports
                </div>
                <a href="{% url 'co_attainment_report_list' %}"
                   class="flex items-center px-3 sm:px-4 py-2.5 sm:py-3 rounded-lg text-sm sm:text-base font-medium transition duration-200
                           {% if 'co_attainment_report' in request.resolver_match.url_name %}bg-indigo-700 text-white shadow-md{% else %}text-indigo-200 hover:bg-indigo-800 hover:text-white{% endif %}">
                    <svg class="w-5 h-5 mr-3 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 17v-2m3 2v-4m3 2v-6m2 9H7a2 2 0 01-2-2V5a2 2 0 012-2h10a2 2 0 012 2v12a2 2 0 01-2 2z"></path></svg>
                    CO Attainment
                </a>
                <a href="{% url 'po_attainment_report_list' %}"
                   class="flex items-center px-3 sm:px-4 py-2.5 sm:py-3 rounded-lg text-sm sm:text-base font-medium transition duration-200
                           {% if 'po_attainment_report' in request.resolver_match.url_name %}bg-indigo-700 text-white shadow-md{% else %}text-indigo-200 hover:bg-indigo-800 hover:text-white{% endif %}">
                    <svg class="w-5 h-5 mr-3 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c1.558 0 3.093.048 4.606.145M12 8a7.964 7.964 0 00-2.348.608M12 8a7.964 7.964 0 012.348.608M9 17.25c.42.062.842.098 1.27.106M9 17.25a6.002 6.002 0 00-2.502-.377c-2.377-.502-4.14-.5-4.14-.5h-.001V12.75a.75.75 0 01.75-.75h3.582a3 3 0 001.309-3.774M15 17.25c-.42.062-.842.098-1.27.106m1.27-.106a6.002 6.002 0 012.502-.377c2.377-.502 4.14-.5 4.14-.5h.001V12.75a.75.75 0 00-.75-.75H17.25a3 3 0 01-1.309-3.774M12 8a9.002 9.002 0 00-2.032-.267M12 8a9.002 9.002 0 012.032-.267M9 17.25c-.42.062-.842.098-1.27.106M9 17.25a6.002 6.002 0 00-2.502-.377c-2.377-.502-4.14-.5-4.14-.5h-.001V12.75a.75.75 0 01.75-.75h3.582a3 3 0 001.309-3.774M15 17.25c-.42.062-.842.098-1.27.106m1.27-.106a6.002 6.002 0 012.502-.377c2.377-.502 4.14-.5 4.14-.5h.001V12.75a.75.75 0 00-.75-.75H17.25a3 3 0 01-1.309-3.774M12 8a9.002 9.002 0 00-2.032-.267"></path></svg>
                    PO Attainment
                </a>
                {% endif %}
            </nav>
        </aside>

        {# --- Main Content Area (Header, Content, Footer) --- #}
        <div class="flex flex-col flex-1 overflow-x-hidden overflow-y-auto">
            {# --- Minimalist Top Header (for mobile menu toggle & user actions) --- #}
            <header class="w-full bg-white shadow-md p-3 sm:p-4 flex justify-between items-center z-20 md:hidden sticky top-0"> {# Only visible on mobile, sticky for better UX #}
                <button id="open-mobile-menu" class="text-gray-600 hover:text-gray-900 focus:outline-none transition duration-200">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
                </button>
                <div class="flex items-center space-x-2 sm:space-x-4">
                    {# User Info & Logout (responsive for mobile) #}
                    {% if user.is_authenticated %}
                        <span class="text-gray-700 text-xs sm:text-sm font-medium hidden xs:block">
                            Hello, <span class="font-semibold">{{ user.username }}</span>
                        </span>
                        <form action="{% url 'logout' %}" method="post" class="inline-block">
                            {% csrf_token %}
                            <button type="submit"
                                    class="px-2 py-1 sm:px-3 sm:py-1.5 bg-indigo-600 rounded-md text-white text-xs sm:text-sm font-medium hover:bg-indigo-700 transition duration-200 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-opacity-50">
                                Logout
                            </button>
                        </form>
                    {% else %}
                        <a href="{% url 'login' %}" class="px-2 py-1 sm:px-3 sm:py-1.5 bg-indigo-600 rounded-md text-white text-xs sm:text-sm font-medium hover:bg-indigo-700 transition duration-200 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-opacity-50">
                            Login
                        </a>
                    {% endif %}
                </div>
            </header>
            
            {# --- Content Area (fully responsive) --- #}
            <main class="flex-grow container mx-auto mt-4 sm:mt-6 p-3 sm:p-4 lg:p-6 xl:p-8 max-w-none">
                {# Django Messages Display - Responsive #}
                {% if messages %}
                    <div class="mb-4 sm:mb-6">
                        {% for message in messages %}
                            <div class="django-message p-3 sm:p-4 mb-3 sm:mb-4 rounded-lg text-xs sm:text-sm border
                                        {% if message.tags == 'success' %}bg-green-100 text-green-800 border-green-200
                                        {% elif message.tags == 'error' %}bg-red-100 text-red-800 border-red-200
                                        {% elif message.tags == 'warning' %}bg-yellow-100 text-yellow-800 border-yellow-200
                                        {% else %}bg-blue-100 text-blue-800 border-blue-200{% endif %}">
                                {{ message }}
                            </div>
                        {% endfor %}
                    </div>
                {% endif %}

                {% block content %}
                    {# Page-specific content will be inserted here #}
                {% endblock %}
            </main>

            <footer class="bg-white text-gray-600 text-center text-xs sm:text-sm border-t border-gray-300 py-2">
                <div class="container mx-auto">
                    <p>&copy; {% now "Y" %} COPO Management System. All rights reserved.</p>
                    <p class="opacity-70">Developed for academic excellence.</p>
                </div>
            </footer>            
        </div>
    </div>

    {# --- JavaScript for Mobile Menu Toggle with improved responsiveness --- #}
    {% block extra_js %}
    <script>
        setTimeout(function () {
            const alerts = document.querySelectorAll('.django-message');
            alerts.forEach(function (alert) {
                alert.style.transition = "opacity 0.3s ease-out";
                alert.style.opacity = '0';
                setTimeout(() => alert.remove(), 500);
            });
        }, 600);
    </script>    
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const openMenuBtn = document.getElementById('open-mobile-menu');
            const closeMenuBtn = document.getElementById('close-mobile-menu');
            const mobileMenuDrawer = document.getElementById('mobile-menu-drawer');
            const mobileMenuOverlay = document.getElementById('mobile-menu-overlay');

            if (openMenuBtn && closeMenuBtn && mobileMenuDrawer && mobileMenuOverlay) {
                function openMobileMenu() {
                    mobileMenuDrawer.classList.remove('-translate-x-full');
                    mobileMenuOverlay.classList.remove('hidden');
                    // Prevent body scroll when menu is open
                    document.body.style.overflow = 'hidden';
                }

                function closeMobileMenu() {
                    mobileMenuDrawer.classList.add('-translate-x-full');
                    mobileMenuOverlay.classList.add('hidden');
                    // Restore body scroll
                    document.body.style.overflow = '';
                }

                openMenuBtn.addEventListener('click', openMobileMenu);
                closeMenuBtn.addEventListener('click', closeMobileMenu);
                mobileMenuOverlay.addEventListener('click', closeMobileMenu); // Close when clicking overlay

                // Close menu with Escape key
                document.addEventListener('keydown', function(e) {
                    if (e.key === 'Escape' && !mobileMenuOverlay.classList.contains('hidden')) {
                        closeMobileMenu();
                    }
                });

                // Close menu if window resized to tablet/desktop
                let resizeTimer;
                window.addEventListener('resize', function() {
                    clearTimeout(resizeTimer);
                    resizeTimer = setTimeout(function() {
                        if (window.innerWidth >= 768) { // Tailwind's 'md' breakpoint
                            closeMobileMenu();
                        }
                    }, 250); // Debounce resize events
                });

                // Handle touch events for better mobile interaction
                let touchStartX = 0;
                let touchEndX = 0;

                mobileMenuDrawer.addEventListener('touchstart', function(e) {
                    touchStartX = e.changedTouches[0].screenX;
                });

                mobileMenuDrawer.addEventListener('touchend', function(e) {
                    touchEndX = e.changedTouches[0].screenX;
                    handleSwipe();
                });

                function handleSwipe() {
                    if (touchEndX < touchStartX - 50) { // Swipe left to close
                        closeMobileMenu();
                    }
                }
            }
        });
    </script>
    {% endblock %}
    {% block extra_js22 %}{% endblock %}
</body>
</html>